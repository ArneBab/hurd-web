%TOC% %STARTINCLUDE%

## <a name="TWiki_Installation_Guide"> TWiki Installation Guide </a>

_Clean install of the current public release (01-Sep-2001)_

### <a name="Overview"> Overview </a>

These installation steps use the Apache web server on Linux as an example. TWiki should run on other web servers and Unix systems as well. (TWiki on Windows is possible, but has not been well-documented. More on that at <http://TWiki.org/cgi-bin/view/Codev/TWikiOnWindows.)>

**_Note:_** Below installation steps assume user `nobody` for all files manupulated by the cgi scripts (executed by the web server), and user `twiki` for all other files. You need to replace user `nobody` with an other user in case the web server executes the script with a different user ( default for Debian is `www-data` ). Also, you can substitute user `twiki` with your own user name.

**_Note:_** Below installation steps assume that you have control over the web server configuraton files. In case you don't - you may be installing on an ISP-hosted server - follow the steps but use these directories instead:

<table border="1" cellpadding="1" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong>TWiki dir:</strong></th>
    <th bgcolor="#99CCCC"><strong>What it is:</strong></th>
    <th bgcolor="#99CCCC"><strong>Where to copy:</strong></th>
    <th bgcolor="#99CCCC"><strong>Example:</strong></th>
  </tr>
  <tr>
    <td><code>twiki/bin</code></td>
    <td> CGI bin </td>
    <td> cgi-bin enabled dir </td>
    <td><code>/home/smith/public_html/cgi-bin/twiki</code></td>
  </tr>
  <tr>
    <td><code>twiki/pub</code></td>
    <td> public files </td>
    <td> htdoc enabled dir </td>
    <td><code>/home/smith/public_html/pub</code></td>
  </tr>
  <tr>
    <td><code>twiki/data</code></td>
    <td> topic data </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/data</code></td>
  </tr>
  <tr>
    <td><code>twiki/templates</code></td>
    <td> web templates </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/templates</code></td>
  </tr>
</table>

Read <http://TWiki.org/cgi-bin/view/Codev/SourceForgeHowTo> in case you want to install TWiki on SourceForge.

### <a name="Standard_Installation"> Standard Installation </a>

Request and download the TWiki %VERSION% distribution in Unix ZIP format from <http://TWiki.org/download.html>.

#### <a name="Step_1_Create_amp_Configure_the_"> Step 1: Create &amp; Configure the Directories </a>

* Create directory `/home/httpd/twiki` and unzip the TWiki distribution into this directory.
* The `twiki/bin` directory of TWiki must be set as a cgi-bin directory. Add `/home/httpd/twiki/bin` to file `/etc/httpd/httpd.conf` with only `ExecCGI` option.
* The `twiki/pub` directory of TWiki must be set so that it is visible as a URL. Add `/home/httpd/twiki` to file `httpd.conf` with normal access options (copy from `/home/httpd/html` ).
* Now add `ScriptAlias` for `/twiki/bin` and `Alias` for `/twiki` to file `httpd.conf` . <br />**_Note:_** The `ScriptAlias` **must** come before the `Alias` in Apache, otherwise it will fail to correctly set up `/twiki/bin/` , due to the fact that it sees that as being just another subdirectory of the `/twiki/` alias. <br />

> **Example `httpd.conf` entries:**
>
> <pre> Script<nop>Alias /twiki/bin/ "/home/httpd/twiki/bin/"
>  Alias /twiki/ "/home/httpd/twiki/"
>  &amp;lt;Directory "/home/httpd/twiki/bin"&amp;gt;
>     Options +ExecCGI
>     Set<nop>Handler cgi-script
>     Allow from all
>  &amp;lt;/Directory&amp;gt;
>  &amp;lt;Directory "/home/httpd/twiki/pub"&amp;gt;
>     Options Follow<nop>Sym<nop>Links +Includes
>     Allow<nop>Override None
>     Allow from all
>  &amp;lt;/Directory&amp;gt;</nop></nop></nop></nop></nop></pre>

#### <a name="Step_2_Check_the_Server_Director"> Step 2: Check the Server Directory Settings </a>

* Restart Apache by `/etc/rc.d/rc5.d/S85httpd restart` .
* Test if the `twiki/bin` directory is cgi-enabled:
  * Enter the URL of that directory into your browser ( `http://your.domain.com/twiki/bin` ). It is not set correctly as cgi-bin in case you get something like `"Index of /twiki/bin"` . It is OK if you get a message like `"Forbidden. You don't have permission to access /twiki/bin/ on this server."`
  * Execute the `testenv` script from your browser ( `http://your.domain.com/twiki/bin/testenv` ). It shows a table with all CGI environment variables and tests the settings in your <code>**twiki/bin/wikicfg.pm**</code> configuration file.

#### <a name="Step_3_Enable_Perl_File_Permissi"> Step 3: Enable Perl File Permissions </a>

* Make sure Perl 5 and the Perl CGI library are installed on your system. Default location of Perl executable is `/usr/bin/perl`. In case Perl is installed in a different location, the first line of all Perl scripts in the <code>**twiki/bin**</code> directory must be changed (alternatively you can create a symbolic link from <code>**/usr/bin/perl**</code> ).
  * **IMPORTANT:** On most ISP virtual domain accounts, Perl CGI scripts require a <code>**.cgi**</code> extension to run. Some systems need <code>**.pl**</code>, the regular Perl extension. Change all <code>**twiki/bin**</code> scripts appropriately if necssary.
* To be able to edit the Perl scripts and <code>**.tmpl**</code> files it is necessary to <code>**chown**</code> and <code>**chgrp -R twiki**</code> so all the files have the owner you want.
* The scripts execute as <code>**nobody**</code>. Set the file permission of all Perl scripts in the <code>**twiki/bin**</code> directory as executable to <code>**-rwxr-xr-x**</code> (755).
* Set the permission of all files below `twiki/data` so that they are writable by user `nobody`. A simple way is to <code>**chmod**</code> them to <code>**-rw-rw-rw-**</code> (666).
* Set the permission of the <code>**twiki/data**</code> directory and its subdirectories so that files in there are writable by user <code>**nobody**</code>. A simple way is to chmod them to <code>**drwxrwxrwx**</code> (777).
* Set the permission of the `twiki/pub` directory and all its subdirectories so that files in there are writable by user `nobody`. A simple way is to chmod them to <code>**drwxrwxrwx**</code> (777).

#### <a name="Step_4_Set_the_Main_Configuratio"> Step 4: Set the Main Configuration File </a>

* Edit the file <code>**twiki/bin/wikicfg.pm**</code> and set the variables at the beginning of the file to your needs.
  * Set the file extension in the `$scriptSuffix` variable to <code>**cgi**</code> or <code>**pl**</code> if required.
  * Make sure RCS is installed. Set `$rcsDir` in `twiki/bin/wikicfg.pm` to mach the location of your RCS binaries.
* Note in case the cgi scripts are **_not_** running as user `nobody`: The `*,v` RCS repository files delivered with the installation package are locked by user `nobody` . In case the user is different (e.g. `www-data` ), it is not possible to check in files, this has the effect that the topic version number does not increase when saving a topic. In this case you need to unlock all repository files and lock them as user `www-data` (check the rcs man pages), or simply delete all the repository files. A simple way to switch the locker of the RCS files is to use sed: <br />`for f in *,v; do sed 's/nobody\:/www-data\:/' $f > x; mv x $f; done`
* **Security issue:** Directories `twiki/data` , `twiki/templates` and all its subdirectories should be set so that they are **not** visible as a URL. (Alternatively, move the directries to a place where they are not visible, and change the variables in `twiki/bin/wikicfg.pm` accordingly)
* Enable email notification of topic changes, [[TWikiDocumentation]] has more.
* Add the [TWiki:Main.PoweredByTWikiLogo](http://TWiki.org/cgi-bin/view/Main/PoweredByTWikiLogo) to your %MAINWEB%.WebHome topic.

#### <a name="Step_5_Finish_Up_from_Your_Brows"> Step 5: Finish Up from Your Browser </a>

* Point your Web browser at <code>**http://your.domain.com/twiki/bin/view**</code> and start TWiki-ing away!
* Edit the [[TWikiPreferences]] topic in the TWiki:%TWIKIWEB% web to set the WIKIWEBMASTER email address, the WEBCOPYRIGHT message and other preferences.
* If you use `.htaccess`, edit the file and add the file extension to `edit`, `view`, `preview`, etc.
* Edit the [[WebNotify]] topic in all webs and set the users you want to notify.

That's it for the standard virgin installation of TWiki. Read on to learn how to customize TWiki.

### <a name="Extra_Server_Level_Options"> Extra Server-Level Options </a>

Complete a Standard Installation and your new TWiki site should be up and running. You can develop and manage most aspects of your site from the browser interface. Core set-up functions require direct access to the server file system, via Telnet or FTP. You can make server-level site changes during installation, or at any time afterwards.

<a name="CreateWeb"></a>

#### <a name="Creating_a_New_Web"> Creating a New Web </a>

* To create a new web:
  * Use a name for the web consisting of characters `A..Z` , `a..z` but **not** in [[WikiNotation]].
  * Create a new template directory under `twiki/templates` .
  * Create a new data directory under `twiki/data` and check the file permission of the directory.
  * Copy the `Web*.txt` files from the `twiki/data/Main` directory to the new data directory, preserving the original files' owner, group and permissions ( on Unix use `cp -p` ). The data files must be writable by the owner the CGI scripts are running on ( usually `nobody` ). Hint: You can set permissions of `.txt` and `.txt,v` files to `-rw-rw-rw-` and then edit the topic using your browser, RCS will restore the file permission correctly when saving the topic.
  * Add the new web to the web list (visible in the upper right corner of each topic) by editing the site-level preferences %TWIKIWEB%.%WIKIPREFSTOPIC%:
    * Add the new web to the WIKIWEBLIST variable.
  * Add the new web to the web table (at the bottom of each [[WebHome]] topic) by editing the %TWIKIWEB%.TWikiWebsTable topic.
  * Change the web preferences by editing the WebPreferences topic of the new web:
    * Set the WEBBGCOLOR variable to a color of your taste. The number represents the unique color for the web (consult an HTML book for colors.)
    * Customize the WEBTOPICLIST variable to contain the web specific links you prefer.
    * Optional: Set the WEBCOPYRIGHT variable to have a web-specific copyright text (at the bottom of each topic).
  * If needed, create customized templates in the new templates directory. (Non existing templates are inherited from `twiki/templates` )
  * If you want to use form templates - see [[FormTemplateSystem]]
  * In case you want usage statistics for this web: Copy file `WebStatistics.txt` from the `twiki/data/Main` directory to the new data directory. Edit topic WebStatistics in the new web and delete old usage entries.
  * Note that user home topics are only located in the %WIKITOOLNAME%.%MAINWEB% web, so don't try to move them or create them in other webs. From any web you can refer to users located in the %WIKITOOLNAME%.%MAINWEB% web like <code>%MAINWEB%.UserName</code> or <code>%MAINWEB%.UserName</code>.

#### <a name="Adding_Variables_amp_Rendering_R"> Adding Variables &amp; Rendering Rules </a>

* You can add new rendering rules or new %VARIABLES%. To insure an easy upgrade of TWiki it is recommended to do this customization in `twiki/bin/wikicfg.pm` , not `twiki/bin/wiki.pm` .

#### <a name="Enabling_Basic_Authentication_ht"> Enabling Basic Authentication (.htaccess) </a>

* If you are on a non authenticated server (i.e. not using SSL) and you would like to authenticate users:
  * Rename file `.htaccess.txt` in the `twiki/bin` directory to `.htaccess` and change it to your needs. For details consult the HTTP server documentation (for Apache server: [[1]](http://www.apache.org/docs/mod/directives.html), [[2]](http://www.mcs.kent.edu/system/web_help/htaccess/introduction.html)). In particular, the following <font>red</font> part needs to be configured correctly: <br /><code>Redirect <font>/urlpath/to/TWiki/index.html</font> http://<font>your.domain.com/urlpath/to/TWiki/bin/</font>view</code><br /><code>AuthUserFile <font>/filepath/to/TWiki/data/</font>.htpasswd</code><br /><code>ErrorDocument 401 <font>/urlpath/to/TWiki/bin/</font>oops/TWiki/TWikiRegistration?template=oopsauth</code>
    * **_Note:_** The browser should ask for login name and password when you click on the <u>Edit</u> link. In case `.htaccess` does not have the desired effect you need to enable it: Add "AllowOverride All" to the Directory section of `access.conf` for your `twiki/bin` directory.
  * Copy the [[TWikiRegistrationPub]] topic to [[TWikiRegistration]]. Do that by either editing the topics in the%TWIKIWEB% web, or by renaming the `.txt` and `.txt,v` files in the `twiki/data/%TWIKIWEB%` directory.
    * **_Note:_** You can customize the registration form if needed, like deleting or adding input tags. The `name=""` parameter of the input tags must start with: `"Twk0..."` (if this is an optional entry), or `"Twk1..."` (if this is a required entry). This will ensure that the fields are processed correctly.
  * A new line containing user name and encrypted password gets added to the `data/.htpasswd` file when a users registers. The file that comes with the TWiki installation contains a few user accounts of TWiki core team members (needed for testing). You can edit the file and delete those lines.

### <a name="TWiki_File_System_Snapshot"> TWiki File System Snapshot </a>

Here are partial directory listings showing typical file permissions and ownership. This is provided for general debugging use only and isn't an exact representation of the current distribution. There is also a complete file [[TWiki/TWikiImplementationNotes]], with individual file descriptions, for the current TWiki release.

Directory `twiki/bin` :

    drwxrwxr-x   2 twiki twiki   4096 Jun 17 16:34 .
    drwxrwxr-x   3 twiki twiki   4096 Jun 17 16:34 ..
    -rw-rw-r--   1 twiki twiki    650 Feb 10  2000 .htaccess
    -rwxrwxr-x   1 twiki twiki   4322 Mar 12 00:31 attach
    -rwxrwxr-x   1 twiki twiki   1426 Jun 20 19:52 delete
    -rwxrwxr-x   1 twiki twiki   9001 Jul 28 11:03 edit
    -rwxrwxr-x   1 twiki twiki   1811 Mar 11 02:27 geturl
    -rwxrwxr-x   1 twiki twiki   5006 Mar 11 02:41 mailnotify
    -rwxrwxr-x   1 twiki twiki   1769 Mar 11 03:07 oops
    -rwxrwxr-x   1 twiki twiki   6890 Jun 21 19:58 preview
    -rwxrwxr-x   1 twiki twiki   7606 Mar 31 18:30 rdiff
    -rwxrwxr-x   1 twiki twiki   8349 Jun 21 18:12 register
    -rwxrwxr-x   1 twiki twiki   2693 Jul  5 14:32 save
    -rwxrwxr-x   1 twiki twiki   3831 Jul 20 12:13 search
    -rwxrwxr-x   1 twiki twiki   9835 Jun 20 19:03 statistics
    -rwxrwxr-x   1 twiki twiki    509 Feb  7  2000 testenv
    -rwxrwxr-x   1 twiki twiki  14543 Jul 20 18:46 upload
    -rwxrwxr-x   1 twiki twiki   4755 May 22 18:11 view
    -rwxrwxr-x   1 twiki twiki   1689 Jun 20 20:10 viewfile

Directory `twiki/templates/` :

    drwxrwxr-x   4 twiki twiki   4096 Aug  3 01:17 .
    drwxrwxr-x   4 twiki twiki   4096 Aug 19 18:38 ..
    drwxrwxr-x   2 twiki twiki   4096 Jun 17 16:35 Know
    drwxrwxr-x   2 twiki twiki   4096 May  1 01:24 Main
    -rw-rw-r--   1 twiki twiki   2688 Aug 15 18:15 attach.tmpl
    -rw-rw-r--   1 twiki twiki   1283 Jul 20 15:56 attachtable.tmpl
    -rw-rw-r--   1 twiki twiki   1907 Jul 28 16:41 changes.tmpl
    -rw-rw-r--   1 twiki twiki   2265 Aug 15 17:57 edit.tmpl
    -rw-rw-r--   1 twiki twiki    965 Feb  8  2000 mailnotify.tmpl
    -rw-rw-r--   1 twiki twiki     30 Jan 13  1999 notedited.tmpl
    -rw-rw-r--   1 twiki twiki    940 Jul 20 15:59 notext.tmpl
    -rw-rw-r--   1 twiki twiki    907 Jul 20 16:01 notwiki.tmpl
    -rw-rw-r--   1 twiki twiki    341 Mar  8 11:39 noweb.tmpl
    -rw-rw-r--   1 twiki twiki   1000 Mar  8 11:40 oops.tmpl
    -rw-rw-r--   1 twiki twiki   1043 Oct 23 19:17 oopsaccesschange.tmpl
    -rw-rw-r--   1 twiki twiki   1036 Oct 23 19:17 oopsaccessview.tmpl
    -rw-rw-r--   1 twiki twiki    914 Mar  8 11:40 oopsdel.tmpl
    -rw-rw-r--   1 twiki twiki   1423 May 29 01:23 oopslocked.tmpl
    -rw-rw-r--   1 twiki twiki   1067 Mar  8 11:41 oopsregexist.tmpl
    -rw-rw-r--   1 twiki twiki    955 Mar  8 11:41 oopsregpasswd.tmpl

Directory `twiki/data/` :

    drwxrwxrwx   6 nobody  nobody  4096 Aug  3 01:09 .
    drwxrwxr-x   4 twiki   twiki   4096 Aug 19 18:38 ..
    -rw-rw-r--   1 nobody  nobody    51 Apr 21 16:48 .htpasswd
    drwxrwxrwx   2 nobody  nobody  4096 Aug 20 17:18 Know
    drwxrwxrwx   2 nobody  nobody  4096 Aug 19 04:15 Main
    drwxrwxrwx   2 nobody  nobody  4096 Aug 20 17:56 TWiki
    -rw-rw-rw-   1 twiki   twiki      1 Mar 11 04:19 debug.txt
    -rw-r--r--   1 nobody  nobody  1516 Aug 20 17:56 log200008.txt

Partial file list for `twiki/data/Main` :

    drwxrwxrwx   2 nobody  nobody  4096 Aug 19 04:15 .
    drwxrwxrwx   6 nobody  nobody  4096 Aug  3 01:09 ..
    -rw-rw-rw-   1 twiki twiki     3716 Aug 19 02:19 .changes
    -rw-rw-rw-   1 twiki twiki        9 Aug 19 02:45 .mailnotify
    -rw-r--r--   1 nobody  nobody   358 Aug 18 17:22 OfficeLocations.txt
    -r--r--r--   1 nobody  nobody   878 Aug 18 17:22 OfficeLocations.txt,v
    -rw-r--r--   1 nobody  nobody   680 Aug 18 17:36 TWikiGuest.txt
    -r--r--r--   1 nobody  nobody  1989 Aug 18 17:36 TWikiGuest.txt,v
    -rw-r--r--   1 nobody  nobody   459 Aug 18 17:19 TWikiUsers.txt
    -r--r--r--   1 nobody  nobody  3840 Aug 18 17:19 TWikiUsers.txt,v
    -rw-r--r--   1 nobody  nobody    95 Aug 19 03:06 WebChanges.txt
    -r--r--r--   1 nobody  nobody   284 Aug 19 03:06 WebChanges.txt,v
    -rw-r--r--   1 nobody  nobody  1853 Aug 18 18:08 WebHome.txt
    -r--r--r--   1 nobody  nobody  6523 Aug 18 18:08 WebHome.txt,v

Directory `twiki/pub/` :

    drwxrwxrwx   6 nobody  nobody  4096 Aug  3 01:21 .
    drwxrwxr-x   3 twiki   twiki   4096 Jun 17 16:35 ..
    drwxrwxrwx   3 nobody  nobody  4096 Jun 17 16:35 Know
    drwxrwxrwx   2 nobody  nobody  4096 Aug  3 01:21 Main
    drwxrwxrwx   3 nobody  nobody  4096 Aug  3 01:21 TWiki
    -rw-rw-r--   1 twiki   twiki   1078 Jan 14  2000 favicon.ico
    drwxrwxr-x   2 twiki   twiki   4096 Jun 17 16:35 icn
    -rw-rw-r--   1 twiki   twiki   3016 Oct  5  1999 twikilogo.gif
    -rw-rw-r--   1 twiki   twiki   5320 Oct  5  1999 twikilogo1.gif
    -rw-rw-r--   1 twiki   twiki   6125 Oct  5  1999 twikilogo2.gif
    -rw-rw-r--   1 twiki   twiki   7218 Oct  5  1999 twikilogo3.gif
    -rw-rw-r--   1 twiki   twiki   6710 Oct  5  1999 twikilogo4.gif
    -rw-rw-r--   1 twiki   twiki   2877 Jun  7  1999 wikiHome.gif

Partial file list for `twiki/pub/icn/` :

    drwxrwxr-x   2 twiki   twiki   4096 Jun 17 16:35 .
    drwxrwxrwx   6 nobody  nobody  4096 Aug  3 01:21 ..
    -rw-rw-r--   1 twiki   twiki    801 Mar 26  1999 _filetypes.txt
    -rw-rw-r--   1 twiki   twiki    143 Mar  9  1999 bat.gif
    -rw-rw-r--   1 twiki   twiki    926 Mar  9  1999 bmp.gif
    -rw-rw-r--   1 twiki   twiki    141 Mar 25  1999 c.gif
    -rw-rw-r--   1 twiki   twiki    144 Mar  9  1999 dll.gif
    -rw-rw-r--   1 twiki   twiki    152 Mar  9  1999 doc.gif

-- [[PeterThoeny]] - 16 Mar 2001 <br />
