%TOC% %STARTINCLUDE%

# <a name="TWiki_Installation_Guide"> TWiki Installation Guide </a>

_Clean install of the current public release (01-Sep-2001)_

## <a name="Overview"> Overview </a>

These installation steps use the Apache web server on Linux as an example. TWiki runs on other web servers and Unix systems as well. (TWiki on Windows is possible, but has not been well-documented. More on that at TWiki:Codev/TWikiOnWindows.)

* **_NOTE:_** This Installation Guide assumes the following:

* * **User `nobody` ** is used for all files manipulated by the CGI scripts (executed by the Web server), and user `twiki` for all other files. Replace user `nobody` with another user if your Web server executes scripts under a different name (default for Debian is `www-data`). Also, you can substitute user `twiki` with your own username.

* * **You have control** over the Web server configuration files. In case you don't - you may be installing on an ISP-hosted server - follow the steps but use these directories instead:

<table border="1" cellpadding="1" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong>TWiki dir:</strong></th>
    <th bgcolor="#99CCCC"><strong>What it is:</strong></th>
    <th bgcolor="#99CCCC"><strong>Where to copy:</strong></th>
    <th bgcolor="#99CCCC"><strong>Example:</strong></th>
  </tr>
  <tr>
    <td><code>twiki/bin</code></td>
    <td> CGI bin </td>
    <td> cgi-bin enabled dir </td>
    <td><code>/home/smith/public_html/cgi-bin</code></td>
  </tr>
  <tr>
    <td><code>twiki/lib</code></td>
    <td> library files </td>
    <td> same level like <code>twiki/bin</code></td>
    <td><code>/home/smith/public_html/lib</code></td>
  </tr>
  <tr>
    <td><code>twiki/pub</code></td>
    <td> public files </td>
    <td> htdoc enabled dir </td>
    <td><code>/home/smith/public_html/pub</code></td>
  </tr>
  <tr>
    <td><code>twiki/data</code></td>
    <td> topic data </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/data</code></td>
  </tr>
  <tr>
    <td><code>twiki/templates</code></td>
    <td> web templates </td>
    <td> outside of htdoc tree (for security) </td>
    <td><code>/home/smith/twiki/templates</code></td>
  </tr>
</table>

Read TWiki:Codev/SourceForgeHowTo in case you want to install TWiki on SourceForge.

## <a name="Standard_Installation"> Standard Installation </a>

Request and download the TWiki 01-Sep-2001 distribution in Unix ZIP format from <http://TWiki.org/download.html>.

### <a name="Step_1_Create_amp_Configure_the_"> Step 1: Create &amp; Configure the Directories </a>

* Create directory `/home/httpd/twiki` and unzip the TWiki distribution into this directory.
* The `twiki/bin` directory of TWiki must be set as a cgi-bin directory. Add `/home/httpd/twiki/bin` to file `/etc/httpd/httpd.conf` with only `ExecCGI` option.
* The `twiki/pub` directory of TWiki must be set so that it is visible as a URL. Add `/home/httpd/twiki` to file `httpd.conf` with normal access options (copy from `/home/httpd/html` ).
* Now add `ScriptAlias` for `/twiki/bin` and `Alias` for `/twiki` to file `httpd.conf` . <br />**_Note:_** The `ScriptAlias` **must** come before the `Alias` in Apache, otherwise it will fail to correctly set up `/twiki/bin/` , due to the fact that it sees that as being just another subdirectory of the `/twiki/` alias. <br />

> **Example `httpd.conf` entries:**
>
> <pre> Script<nop>Alias /twiki/bin/ "/home/httpd/twiki/bin/"
>  Alias /twiki/ "/home/httpd/twiki/"
>  &amp;lt;Directory "/home/httpd/twiki/bin"&amp;gt;
>     Options +ExecCGI
>     Set<nop>Handler cgi-script
>     Allow from all
>  &amp;lt;/Directory&amp;gt;
>  &amp;lt;Directory "/home/httpd/twiki/pub"&amp;gt;
>     Options Follow<nop>Sym<nop>Links +Includes
>     Allow<nop>Override None
>     Allow from all
>  &amp;lt;/Directory&amp;gt;</nop></nop></nop></nop></nop></pre>

### <a name="Step_2_Check_the_Server_Director"> Step 2: Check the Server Directory Settings </a>

* Restart Apache by `/etc/rc.d/rc5.d/S85httpd restart` .
* Test if the `twiki/bin` directory is CGI-enabled:
  * Enter the URL of that directory into your browser ( `http://your.domain.com/twiki/bin` ). It is not set correctly as cgi-bin in case you get something like `"Index of /twiki/bin"` . It is OK if you get a message like `"Forbidden. You don't have permission to access /twiki/bin/ on this server."`
  * Execute the `testenv` script from your browser ( `http://your.domain.com/twiki/bin/testenv` ). It shows a table with all CGI environment variables. It also tests the settings in your <code>**twiki/lib/TWiki.cfg**</code> configuration file, which you will set later on.

### <a name="Step_3_Enable_Perl_File_Permissi"> Step 3: Enable Perl File Permissions </a>

* Make sure Perl 5 and the Perl CGI library are installed on your system. Default location of Perl executable is `/usr/bin/perl`. In case Perl is installed in a different location, the first line of all Perl scripts in the <code>**twiki/bin**</code> directory must be changed (alternatively you can create a symbolic link from <code>**/usr/bin/perl**</code> ).
  * **IMPORTANT:** On most ISP virtual domain accounts, Perl CGI scripts require a <code>**.cgi**</code> extension to run. Some systems need <code>**.pl**</code>, the regular Perl extension. Change all <code>**twiki/bin**</code> scripts appropriately if necessary.
* To be able to edit the Perl scripts and <code>**.tmpl**</code> files it is necessary to <code>**chown**</code> and <code>**chgrp -R twiki**</code> so all the files have the owner you want.
* The CGI scripts execute as <code>**nobody**</code>. Set the file permission of all Perl scripts in the <code>**twiki/bin**</code> directory as executable to <code>**-rwxr-xr-x**</code> (755).
* Set the permission of all files below `twiki/data` so that they are writable by user `nobody`. A simple way is to <code>**chmod**</code> them to <code>**-rw-rw-r--**</code> (664) and to <code>**chown**</code> them to <code>**nobody**</code>.
* Set the permission of the <code>**twiki/data**</code> directory and its subdirectories so that files in there are writable by user <code>**nobody**</code>. A simple way is to chmod them to <code>**drwxrwxr-x**</code> (775) and to <code>**chown**</code> them to <code>**nobody**</code>.
* Set the permission of the `twiki/pub` directory and all its subdirectories so that files in there are writable by user `nobody`. A simple way is to <code>**chmod**</code> them to <code>**drwxrwxr-x**</code> (775) and to <code>**chown**</code> them to <code>**nobody**</code>.

### <a name="Step_4_Set_the_Main_Configuratio"> Step 4: Set the Main Configuration File </a>

* Edit the file <code>**twiki/lib/TWiki.cfg**</code> and set the variables to your needs.
  * Set the file extension in the `$scriptSuffix` variable to <code>**cgi**</code> or <code>**pl**</code> if required.
  * Make sure RCS is installed. Set `$rcsDir` in `twiki/lib/TWiki.cfg` to mach the location of your RCS binaries.
* Note in case the CGI scripts are **_not_** running as user `nobody`: The `*,v` RCS repository files delivered with the installation package are locked by user `nobody` . In case the user is different (e.g. `www-data` ), it is not possible to check in files, this has the effect that the topic version number does not increase when saving a topic. In this case you need to unlock all repository files and lock them as user `www-data` (check the rcs man pages), or simply delete all the repository files. A simple way to switch the locker of the RCS files is to use sed: <br />`for f in *,v; do sed 's/nobody\:/www-data\:/' $f > x; mv x $f; done`
* **Security issue:** Directories `twiki/data` , `twiki/templates` and all its subdirectories should be set so that they are **not** visible as a URL. (Alternatively, move the directories to a place where they are not visible, and change the variables in `twiki/lib/TWiki.cfg` accordingly)
* Enable email notification of topic changes, [[MonitoringSiteActivity]] has more.
* Add the TWiki:Main/PoweredByTWikiLogo to your %MAINWEB%.WebHome topic.

### <a name="Step_5_Finish_Up_from_Your_Brows"> Step 5: Finish Up from Your Browser </a>

* Point your Web browser at <code>**http://your.domain.com/twiki/bin/view**</code> and start TWiki-ing away!
* Edit the [[TWikiPreferences]] topic in the TWiki:%TWIKIWEB% web to set the WIKIWEBMASTER email address, the WEBCOPYRIGHT message and other preferences.
* Edit the [[WebNotify]] topic in all webs and set the users you want to notify.

That's it for the standard virgin installation of TWiki. Read on to learn how to customize TWiki.

## <a name="Additional_Server_Level_Options"> Additional Server-Level Options </a>

Complete a Standard Installation and your new TWiki site should be up and running. You can develop and manage most aspects of your site from the browser interface. Core set-up functions require direct access to the server file system, via Telnet or FTP. You can make server-level site changes during installation, or at any time afterwards.

<a name="CreateWeb"></a>

### <a name="Creating_a_New_Web"> Creating a New Web </a>

* To create a new web:
  1. **Create** a new web data directory under `twiki/data` and check the file permission of the directory.
    * Use a name consisting of characters `A..Z` , `a..z` but **_not_** in [[WikiNotation]].
  2. **Copy** all files from the `twiki/data/_default` directory to the new data directory, preserving the original files' owner, group and permissions (on Unix, use `cp -p`). The data files must be writable by the owner the CGI scripts are running on (usually, `nobody`).
    * **_Hint:_** You can set permissions of `.txt` and `.txt,v` files to `-rw-rw-rw-` (666) and then edit the topic using your browser; RCS will restore the file permissions correctly when saving the topic.
  3. **Add** the new web to the web list (visible in the upper right corner of each topic) by editing the site-level preferences, %TWIKIWEB%.%WIKIPREFSTOPIC%:
    * Add the new web to the <code>%WIKIWEBLIST%</code> variable.
  4. **Update** the web settings by editing the WebPreferences topic of the new web:
    * Customize the <code>%WEBTOPICLIST%</code> variable to contain the web-specific links you prefer.
    * Set the WEBBGCOLOR variable to a color. The number represents the unique color for the web.
    * Set Plugins, access privileges, custom variables, other web-level options (ex: <code>%WEBCOPYRIGHT%</code> can be set for an individual web).
  5. **Add** the new web to the color-coded web directory table by editing the %TWIKIWEB%.TWikiWebsTable topic.
  6. **Test** the new web: view pages, create a new page.

* That's it for a basic new web set-up. You can also further customize the web:
  * Create customized templates in the new templates directory (otherwise, templates are inherited from `twiki/templates`).
    * **_NOTE:_** For web-specific templates in a `templates` subdirectory, ex: `twiki/templates/someweb`.
  * Create [[TWikiForms]] to add form-based page input that's stored separately from the main free-form topic text.

* **_NOTE:_** User home topics are located in the %WIKITOOLNAME%.%MAINWEB% web - don't try to move them or create them in other webs. From any web you can refer to users located in the %WIKITOOLNAME%.%MAINWEB% web with <code>%MAINWEB%.UserName</code> or <code>%MAINWEB%.UserName</code> - using the <code>%MAINWEB%</code> variable is preferable, particularly if you might change the %MAINWEB% web name.

### <a name="Adding_Variables_amp_Rendering_R"> Adding Variables &amp; Rendering Rules </a>

* You can add new <code>%VARIABLES%</code>. Define site-level variables in the [[TWikiPreferences]] topic. See also [[TWikiVariables]].
* You can add new rendering rules or add new functionality to TWiki. To insure an easy upgrade of TWiki, it is recommended to do this sort of customization with [[TWikiPlugins]] and the Plugins API.

### <a name="Enabling_Basic_Authentication_ht"> Enabling Basic Authentication (.htaccess) </a>

* If you are on a non-authenticated server - not using SSL - and you would like to authenticate users:
  1. **Rename** file `.htaccess.txt` in the `twiki/bin` directory to `.htaccess` and change it to your needs. For details, consult the HTTP server documentation (for Apache server: [[1]](http://www.apache.org/docs/mod/directives.html), [[2]](http://www.mcs.kent.edu/system/web_help/htaccess/introduction.html)). In particular, the following <font>red</font> part needs to be configured correctly: <br /><code>Redirect <font>/urlpath/to/TWiki/index.html</font> http://<font>your.domain.com/urlpath/to/TWiki/bin/</font>view</code><br /><code>AuthUserFile <font>/filepath/to/TWiki/data/</font>.htpasswd</code><br /><code>ErrorDocument 401 <font>/urlpath/to/TWiki/bin/</font>oops/TWiki/TWikiRegistration?template=oopsauth</code>
    * **_NOTE:_** In case you renamed the CGI script files to have a file extension you need to reflect that in the `edit`, `view`, `preview`, etc entries in `.htaccess`.
    * **_NOTE:_** The browser should ask for login name and password when you click on the <u>Edit</u> link. In case `.htaccess` does not have the desired effect you need to enable it: Add "AllowOverride All" to the Directory section of `access.conf` for your `twiki/bin` directory.
  2. **Copy** the [[TWikiRegistrationPub]] topic to [[TWikiRegistration]]. Do that by either editing the topics in the%TWIKIWEB% web, or by renaming the `.txt` and `.txt,v` files in the `twiki/data/%TWIKIWEB%` directory.
    * **_NOTE:_** You can customize the registration form if needed, like deleting or adding input tags. The `name=""` parameter of the input tags must start with: `"Twk0..."` (if this is an optional entry), or `"Twk1..."` (if this is a required entry). This will ensure that the fields are processed correctly.

* * A new line containing user name and encrypted password gets added to the `data/.htpasswd` file when a users registers. The file that comes with the TWiki installation contains a few user accounts of TWiki core team members (needed for testing). You can edit the file and delete those lines.

## <a name="TWiki_File_System_Info"> TWiki File System Info </a>

See [[TWikiDocumentation]] for an installed system snapshot and descriptions of all files in the TWiki 01-Sep-2001 distribution.

-- [[MikeMannix]] - 14 Sep 2001 <br /> -- [[Main/PeterThoeny]] - 13 Sep 2001 <br />
