%TOC% %STARTINCLUDE%

## <a name="Form_Templates"> Form Templates </a>

Topics allow for flexible free format data, sometimes you want to ensure strucutre to some of the topic information, this can be done with Forms e.g. saying what type of topic it is (e.g. Bug, Feature, FAQ entry etc) and then filling in fields using dropdowns, radio buttons etc.

If forms are enabled for a Web and a topic has a form you will see it as a table when viewing the page. When you edit you will see the various edit controls below the normal text area. There will be a button at the top of the form marked _Change_ which allows you to change to a different form, or remove the form. If you edit a topic without a form, there will be a button _Add Form_, that let's you associate a form with the topic; note that changes you have made to the topic are not lost when you select this option.

You can search for topics with specific form data using the %SEARCH% variable - see [[TWikiVariables]].

### <a name="Terminology"> Terminology </a>

* **Form Template:** A set of fields defining a form. (_Class_ in OO speak; used to be called _category table definition_)
  * A web may contain more then zero or more form template.
* **Form:** A topic containing additional meta-data (besides the free form TEXTAREA) which categorizes the content. (_Object_ in OO speak; used to be called _category table_)
  * A topic has zero or one of the defined forms. So there are topics with a form or without.
* **Form Field:** A named item in a form. (Used to be called _category item name_)
* **Field Type:** The type of a field when editing a form. The type defines the HTML INPUT tag widgets when editing a topic:
  * **select:** Drop down box or selector
  * **checkbox:** One or more check boxes
  * **checkbox+buttons:** One or more check boxes, plus _set_ and _clear_ buttons to set/clear all check boxes
  * **radio:** One or more radio buttons
  * **text:** A one-line text field
  * **textarea:** A general text area - size is _rows_x_cols_ e.g. 40x10
* **Field Value:** Value of a form field. Can be one or more values from a fixed set (select, checkbox, radio type) or free form (text type). (Used to be called _category item value_)

### <a name="Specification"> Specification </a>

#### <a name="Enable_forms_for_a_web"> Enable forms for a web </a>

By default topics can be edited in free form. A form can be added to a topic to give it more structure. Forms are enabled on a per web basis.

The <code>**WEBFORMS**</code> variable in [[WebPreferences]] is optional and defines a list of possible form templates e.g.

* Set WEBFORMS = BugForm, FeatureForm, BookLoanForm

With this present an extra button is added to the edit view. If the topic doesn't have a form an _Add Form_ button appears at the end of the topic. If a form is present a _Change_ button appears in the top row of the form to the right of the form name. The buttons leads to a screen that enables _no form_ to be selected of one of those specified by `WEBFORMS`.

A default form template (i.e. new topics get this default form) can be provided by creating the <code>**WebTopicEditTemplate**</code> topic in a Web and adding a form to it. Initial form values can be set here.

Addtionaly a new topic can be given a form using the `formtemplate` parameter in the URL. Initial values can then be provided in the URLs or as form values. Names being:

* Not checkboxs - nameFLD e.g. ?BugPriorityFLD=1
* Checkbox - nameFLDvalue=1 e.g. ?ColourFLDRed=1. Note that all boxes with a tick must be specified.

#### <a name="Defining_a_form_template"> Defining a form template </a>

Form templates are defined by topics, one topic per form template. A form template topic has descriptive text mixed with the form template definition in the form of a TWiki table.

### <a name="Examples"> Examples </a>

#### <a name="Defining_form_in_one_topic"> Defining form in one topic </a>

Example: WebFormTemplate of the TWiki.Know web:

<table border="1" cellpadding="1" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong>Name:</strong></th>
    <th bgcolor="#99CCCC"><strong>Type:</strong></th>
    <th bgcolor="#99CCCC"><strong>Size:</strong></th>
    <th bgcolor="#99CCCC"><strong>Values:</strong></th>
    <th bgcolor="#99CCCC"><strong>Tooltip message:</strong></th>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Topic Classification</font></span><a href="http://LOCATIONKnow/TopicClassification">?</a></td>
    <td> select </td>
    <td> 1 </td>
    <td><span style="background:"><font color="">No Disclosure</font></span><a href="http://LOCATIONKnow/NoDisclosure">?</a>, <span style="background:"><font color="">Public Supported</font></span><a href="http://LOCATIONKnow/PublicSupported">?</a>, <span style="background:"><font color="">Public FAQ</font></span><a href="http://LOCATIONKnow/PublicFAQ">?</a></td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Operating System</font></span><a href="http://LOCATIONKnow/OperatingSystem">?</a></td>
    <td> checkbox </td>
    <td> 3 </td>
    <td><span style="background:"><font color="">Os HPUX</font></span><a href="http://LOCATIONKnow/OsHPUX">?</a>, <span style="background:"><font color="">Os Linux</font></span><a href="http://LOCATIONKnow/OsLinux">?</a>, <span style="background:"><font color="">Os Solaris</font></span><a href="http://LOCATIONKnow/OsSolaris">?</a>, <span style="background:"><font color="">Os Win</font></span><a href="http://LOCATIONKnow/OsWin">?</a></td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Os Version</font></span><a href="http://LOCATIONKnow/OsVersion">?</a></td>
    <td> text </td>
    <td> 16 </td>
    <td>   </td>
    <td> blah blah... </td>
  </tr>
</table>

#### <a name="Defining_a_form_in_multiple_topi"> Defining a form in multiple topics </a>

The form template can also be defined in an alternative way by using more then one topic:

* A **form template topic** defines the form
* Values of fields that have more then one value, e.g. of type radio, select and checkbox can be defined by **field value template topics**

Above Example:

* WebFormTemplate of the TWiki.Know web: <table border="1" cellpadding="1" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong>Name:</strong></th>
    <th bgcolor="#99CCCC"><strong>Type:</strong></th>
    <th bgcolor="#99CCCC"><strong>Size:</strong></th>
    <th bgcolor="#99CCCC"><strong>Values:</strong></th>
    <th bgcolor="#99CCCC"><strong>Tooltip message:</strong></th>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Topic Classification</font></span><a href="http://LOCATIONKnow/TopicClassification">?</a></td>
    <td> select </td>
    <td> 1 </td>
    <td>   </td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Operating System</font></span><a href="http://LOCATIONKnow/OperatingSystem">?</a></td>
    <td> checkbox </td>
    <td> 3 </td>
    <td>   </td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Os Version</font></span><a href="http://LOCATIONKnow/OsVersion">?</a></td>
    <td> text </td>
    <td> 16 </td>
    <td>   </td>
    <td> blah blah... </td>
  </tr>
</table>

* TopicClassification topic: <table border="1" cellpadding="1" cellspacing="0">
  <tr>
    <th bgcolor="#99CCCC"><strong>Name:</strong></th>
    <th bgcolor="#99CCCC"><strong>Type:</strong></th>
    <th bgcolor="#99CCCC"><strong>Tooltip message:</strong></th>
  </tr>
  <tr>
    <td><span style="background:"><font color="">No Disclosure</font></span><a href="http://LOCATIONKnow/NoDisclosure">?</a></td>
    <td> option </td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Public Supported</font></span><a href="http://LOCATIONKnow/PublicSupported">?</a></td>
    <td> option </td>
    <td> blah blah... </td>
  </tr>
  <tr>
    <td><span style="background:"><font color="">Public FAQ</font></span><a href="http://LOCATIONKnow/PublicFAQ">?</a></td>
    <td> option </td>
    <td> blah blah... </td>
  </tr>
</table>

#### <a name="Notes"> Notes </a>

* This format allows you to define field items with / without [[TWiki/WikiNames]], depending on your needs.
* The topic can be protected in the usual manner so that not everybody can change the form template - see [[TWikiAccessControl]]
* `...` can be used for force a link, at present `...` format is not supported
* The "Tooltip message:" column is used as a tool tip for the field name (only if field name is a [[TWiki/WikiName]]) - you only see the tooltip on edit
* The first item in the list is the default item. Alternative initial values can be given in a topic template such as <code>**WebTopicEditTemplate**</code> or using fieldFLD=value or for checkboxes fieldFLDcheckbox=1 in URL
* The topic definition is not read when a topic is viewed

### <a name="Changes_from_category_system"> Changes from category system </a>

Main changes from [[TWikiCategoryTable]]:

* Name changed in the hope that form is more readily understandable than category
* The templates for category view/edit have been dropped
* Forms are defined by topics, categories were defined in a template file
* A Web can have multiple forms, only one category was possible
* Form data is saved in meta variables - see [[MetaDataDefinition]], and render to HTML on viewing. Category data was stored as HTML
* The UseCategory radio button has gone, the replacement being the _Change_ form and _Add Form_ buttons.

### <a name="Creating_new_topics_with_forms"> Creating new topics with forms </a>

When you create a new topic in a web that has the WEBFORMS preferences variable set you will get a _Add Form_ button at the bottom of the page. However, if the [[WebTopicEditTemplate]] topic has had a form added this will appear with values set; _Change_ in the form can be pressed to remove the template or switch to a different one.

A form embedded in a topic can also cause a form to be present in a new topic, this is done by specifying the `formtemplate` parameter in the URL.

### <a name="Topic_meta_data"> Topic meta data </a>

See [[MetaDataDefinition]].

The form template topic name and all form fields/values are stored in the topic meta data. The form template topic name is needed for edit and save.

The order of form field/value items in the meta-data is the same as in the form template.

### <a name="UI_for_multiple_form_templates"> UI for multiple form templates </a>

* Optional <code>**WEBFORMS**</code> variable defines possible form templates that can be selected after pressing "Change" (forms) button on edit page
* A template topic can use any form template
* Decided not to ask user to choose a template or form template when creating a topic as goes against the KISS of Wiki systems.
* New topics with a form get instantiated by simple HTML forms asking for a topic name, i.e. there is a SubmitExpenseReport topic were you can create new expense reports, a SubmitVacationRequest topic and so on. These can specify the required template topic and hence form.

### <a name="Migration_of_Category_informatio"> Migration of Category information </a>

Principle: new system should work with old data with no special conversion.

Old data should be transparently upgraded to the new meta format when a topic is edit/previewed/saved.

On upgrading the administrator must produce a form template topic for each Web that using the old category system. `twikicatitems.tmpl` defines the categories and is used in the conversion. The form template must be put as first item in [[WebPreferences]] variable `=WEBFORM`. If it's not present `view` works, but `edit` results in an _oops_ dialog results. If things aren't working correctly there may be entries `data/warning.txt`.

### <a name="History"> History </a>

This is a more general replacement for the [[TWikiCategoryTable]] capability, in particular Forms are defined by special topics, where as categories were defineind using special templates.

-- [[JohnTalintyre]] - 16 Aug 2001 <br />
