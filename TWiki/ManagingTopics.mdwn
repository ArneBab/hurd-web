%TOC% %STARTINCLUDE%

## <a name="Modifying_Topics"> Modifying Topics </a>

Select rename/move when viewing a topic to change its name, delete it or move it

1. Select target Web if other than existing Web
2. Fill in new name - defaults to current name
3. You will be warned if there are locks or if there is a name clash
4. A list of _links_ to the topic will be listed, by default these links will be updated, click checkbox to prevent this
5. Press the Rename/Move button, topic will be renamed and links to the topic updated as requested.
  * If any of the referring pages are locked then they will be listed
  * You can correct these later by again pressing Rename/Move

### <a name="Referring_topics"> Referring topics </a>

Referring topics are found using the the %SEARCH% variable, see the template <code>**searchrenameview.tmpl**</code>. First, matching topics in the current Web are listed - matches are to _topic_. Next, all Webs (including the current one) are listed that match _web.topic_. Because %SEARCH% is used, Webs marked in [[WebPreferences]] as NOSEARCHALL will not show up in the search for refernces to the _topic_ being changed.

Changed references are kept are as short as possible, i.e. _topic_ is used in preference to _web.topic_.

### <a name="Deleting_a_topic"> Deleting a topic </a>

Topics can be _deleted_ by moving them to the <code>**Trash Web**</code>. Note that topics from all Webs go into this, so there could be name clashes, the user is warned of this and asked to choose a new name. When TWiki support sub-webs, these could be created on demand in the Trash Web, which would avoid this name clash problem.

It is up to the administrator of a TWiki installation to clean the Trash Web periodically e.g. by archiving to tape of CDROM entries older than 6 months.

### <a name="Redirection_from_old_topic"> Redirection from old topic </a>

Something like the following can be put in %TWIKIWEB%.WebTopicViewTemplate and %TWIKIWEB%.WebTopicNonWikiTemplate to show if a topic has moved. It does this by searching for the tag %META:TOPICMOVED\{...\}%.

<pre>
%<nop>METASEARCH{type="topicmoved" web="%WEB%" topic="%TOPIC%" title="This topic used to exist and was moved to: "}%
</nop></pre>

### <a name="Permissions"> Permissions </a>

Permissions affect rename in various ways. To rename a topic you need both change and rename permissions. To alter refering topics, you need change permission. See [[TWikiDocumentation]] for information on setting up permissions.

### <a name="Approach"> Approach </a>

* %SEARCH% is used with a special template to show text in topics that requires alteration to point to the new topic name. This includes relavent [[TWikiDocumentation]]
  * User chooses which topics will be altered
* &lt;PRE&gt; and &lt;verbatim&gt; are honoured - no changes to text within these areas
* Topic is moved (if locks allow)
* References are changed (locks and permissions allowing)
* Any refering topics that can't be changed due to locks are listed - user can try getting these references changed at any time.

### <a name="Limitations"> Limitations </a>

Rename in TWiki is fairly complicated due to the dynamic generation of links. Ideally it would be possible to run the required part of rendering in a way that would allow identification of the text to be changed. Unfortunately, these hooks don't exist in TWiki at present. Instead, %SEARCH% is used with a special template to show the text to be changed. And the selected topics and then altered. Search can show matches that will not be updated e.g. because of case differences. Other mis-matches to actual rendered output are also possible as the approaches are so different.

The following shows some limitations of square bracket processing.

    [[Old Topic]]  => [[NewTopic][Old Topic]]
    [[old topic]]  => [[NewTopic][old topic]]
    [[old t opic]] => not changed
    [[OldTopic]]   => [[NewTopic]]
